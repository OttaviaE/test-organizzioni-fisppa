---
title: "Introduzione a R"
subtitle: "Test per le organizzaioni"
author: Ottavia M. Epifania, Margherita Calderan
date: ""
format:
  beamer:
    slide-level: 3
    toc-depth: 3
    theme: Montpellier
    colortheme: dove
    navigation: horizontal
    highlight-style: tango
    classoption: compress, aspectratio=149
    innertheme: rounded
    outertheme: miniframes
callout-icon: false
code-annotations: below
header-includes: |
  \usepackage{graphicx}
  \usepackage{xcolor}
  \definecolor{ColPrimario}{RGB}{100,8,58}
  \definecolor{ColSecondario}{RGB}{20,143,184}
  \setbeamercolor{structure}{fg=ColPrimario}
  \setbeamercolor{itemize item}{fg=ColPrimario}
  \setbeamercolor{itemize subitem}{fg=ColSecondario}
  \setbeamercolor{palette primary}{bg=ColPrimario,fg=white}
  \setbeamercolor{palette secondary}{bg=ColSecondario,fg=white}
  \setbeamercolor{section in head/foot}{bg=ColPrimario,fg=white}
  \setbeamercolor{subsection in head/foot}{bg=ColSecondario,fg=white}
  \setbeamercolor{separation line}{fg=white}
  \setbeamercolor{upper separation line head}{bg=white}
  \setbeamercolor{middle separation line head}{bg=white}
  \setbeamercolor{lower separation line head}{bg=white}
  \AtBeginSubsection{}
  \AtBeginDocument{\institute[]{Università di Padova} }
  \AtBeginDocument{\author{Ottavia M. Epifania\\\texttt{ottavia.epifania@unipd.it}\\[0.5em]Margherita Calderan\\\texttt{margherita.calderan@unipd.it}}}
  \AtBeginSection[]
          {
             \begin{frame}[plain]
             \tableofcontents[currentsection, hideallsubsections]
              \end{frame}
          }
   \AtBeginSubsection[]
          {
             \begin{frame}[plain]
             \tableofcontents[currentsection,currentsubsection,hideothersubsections]
             \end{frame}
          }
editor_options: 
  chunk_output_type: console
execute: 
  echo: true
---

# Introduzione

[**R**](https://www.r-project.org/) è un linguaggio di programmazione fortemente votato alla statistica, gestione di dati e visualizzazione.

E' nato nel 1993 da **Ross Ihaka** e **Robert Gentleman**.

E' un software completamente **open-source** e **gratuito** in continua evoluzione e cambiamento.

![](img/R_logo.png){fig-align="center" width="80"}

### Perchè R?

Un software si definisce open-source quando il **codice sorgente è disponibile** a tutti per essere **modificato**, **aggiornato** e **controllato**.

R è **sia open-source che gratuito** e vanta una community estremamente attiva, come spesso accade con tutti i progetti open-source e in generale i linguaggi di programmazione.

###

Il principale "concorrente" di R è sicuramente **Python** che offre un ambiente altrettanto potente, sviluppato e attivo.

Non è facile (e forse non è possibile) capire quale sia il migliore.

In ogni caso, una volta imparato R, imparare Python sarà molto semplice.

###

Nell'ambito della statistica ci sono vari software non open-source ed a pagamento come:

-   Statistica
-   SPSS
-   STATA
-   SAS

###

Sono degli ottimi software ma:

-   Non forniscono conoscenze trasversali
-   Siete legati ad uno specifico ambiente
-   Le licenze possono costare molto
-   La community non è altrettanto attiva (non open-source)

###

Ci sono degli ottimo software open-source basati su R come:

-   [Jamovi](https://www.jamovi.org/)
    -   **pros**: si può accedere al codice R sottostante
    -   **cons**: le funzioni sono comunque limitate, grafici, modelli complessi
-   [Jasp](https://jasp-stats.org/)
    -   **pros**: molti modelli anche avanzati
    -   **cons**: non si può vedere il codice R

###

Imparare in linguaggio come R vi permette di conoscere uno strumento molto potente ma anche di imparare:

-   Ragionare e risolvere problemi con il codice
-   Trasferire quello che avete imparato ad altri linguaggi
-   Essere sempre autonomi e non legati ad uno specifico ambiente
-   Avere una skill realmente di valore

## Installare R e R-Studio

Entrambi vanno installati separatamente e la procedura varia a seconda del proprio sistema operativo.

Se non l'avete già installato, seguite la procedura spiegata a questo link: <https://posit.co/download/rstudio-desktop/>

###

Se non volete/non riuscite nell'installazione, potete accedere ad R-studio attraverso il server: <https://posit.cloud/> (collegatevi attraverso la mail unipd)

## Come lavorare in R

![](img/workspace.png){fig-align="left" width="400"}

###

**Environment.** La vostra scrivania quando lavorate in R. Contiene tutti gli oggetti (variabili) creati durante la sessione di lavoro.

::: fragment
**Script.** File di testo dove il codice viene salvato e puo essere lanciato in successione. Nello script è possibile combinare codice e commenti (#)

```{r, echo = TRUE}
# assegno ad x il valore 30
x = 30
```
:::

::: fragment
**Working Directory.** La posizione (cartella) sul vostro PC dove R sta lavorando e nella quale R si aspetta di trovare i vostri file, se non specificato altrimenti.
:::

### console vs. script

::: callout-note
## Console

I comandi nella console vengono eseguiti e non salvati

Per eseguire il comando $\rightarrow$ `Invio`

L'output è immediato ed appare nella console
:::

\pause

::: callout-note
## Script

è possibile salvare gli script con tutti i comandi salvati

Per eseguire il comando $\rightarrow$ `Ctrl + Invio` (`cmd + Enter`)

L'output è restituito nella console
:::


### Working Directory

Dove sta lavorando R ?

```{r, echo = TRUE}
getwd()
```

(Se voglio cambiare la working directory, posso utilizzare il comando `setwd`)

```{r, echo=TRUE, eval=FALSE}
setwd('/Users/tita/Desktop')
```

### Path Assoluto

```         
|- Users
    | 
    |- tita 
        |
        |- test-organizzioni-fisppa
            |
            |-slides
                |
                |-00-IntroR
```

Io sto lavorando dentro la cartella `00-IntroR`.

###

Dato che sto lavorando dentro la cartella, se voglio caricare un file che si trova dentro questa cartella posso scrivere semplicemente il nome del file tra virgolette, ed utilizzare per esempio la funzione `read.csv`:

```{r, echo=TRUE, warning=FALSE, eval=FALSE}
data = read.csv("prova.csv")
```

Se il file si trova in una sottocartella (es. data), devo aggiungere quest'informazione al path:

```{r, echo=TRUE, warning=FALSE, eval=FALSE}
data = read.csv("data/prova.csv")
```

**N.B.** Per specificare il path scrivere `/` non `\`


###

Creiamo uno script:

![](img/script.png){fig-align="center" width="400"}

###

Salviamo:

::::: columns
::: {.column width="20%"}
![](img/save1.png){fig-align="center" width="150"}
:::

::: {.column width="80%"}
![](img/save2.png){fig-align="center" width="250"}
:::
:::::

## Oggetti 

Tutto quello che possiamo creare in R viene definito oggetto (e.g., numeri, vettori, matrici, funzioni). 

```{r, echo = TRUE}
numero = 4; numero
```

```{r, echo = TRUE}
vettore = c(1,2,3,4); vettore
```

```{r, echo = TRUE}
matrice = matrix(nrow = 2, ncol = 2, data = vettore); matrice
```


### Creare/nominare oggetti

Gli oggetti si possono creare e tramite il comando **`<-`** oppure **`=`**

```{r, echo = TRUE}
x1 = 3 # nome = oggetto
x1

x2 =3 # nome =oggetto
x2 

x1 == x2 # i due oggetti sono identici?
```


### Principali tipi di dato 

-   **`character`**: Stringhe di caratteri i cui valori alfanumerici vengono delimitati dalle doppie vigolette "Hello world!" o virgolette singole 'Hello world!'
-   **`numeri`**: interi e/o decimali

<br/>

```{r}
A = 12.8 # variabile numerica
nome = "giorgio"  # variabile character
b1 = c(12, 0.3, 5, 778.3) # vettore numerico
Nomi3 = c("giorgio", "ugo", "anna") # vettore character
```

### Regole sulla denominazione di oggetti

-   Deve iniziare con una lettera e può contenere lettere, numeri, underscore ( \_ ), o punti (.).
-   Potrebbe anche iniziare con un punto (.) ma in tal caso non può essere seguito da un numero.

```{r, echo = TRUE, warning=TRUE, error=TRUE}
.3 = 3 

.x = 3
```

###

-   Non deve contenere caratteri speciali come #, &, \$, ?, etc.

-   Non deve essere una parola riservata ovvero quelle parole che sono utilizzate da R con un significato speciale (?reserved).

```{r, echo = TRUE,warning=TRUE, error=TRUE}
TRUE = 3

```

```{r, echo = TRUE,warning=TRUE, error=TRUE}
if = 3

```

###

Ci sono alcuni nomi che non sono proibiti ma sono sconsigliati

```{r, echo = TRUE}
T
F
sum(2,3)
sum = 4
```

###

Tra i diversi linguaggi, le *convenzioni di denominazione* per i nomi di variabili più lunghi e composti da più parole privilegiano **`snake_case`** (ad esempio, "**my_data**") o **`camelCase`** (ad esempio, "**myData**"), e **abbreviazioni** dove appropriato (ad esempio, "**unipdData**" meglio di "university_of_padova_dataset").

###

R è case-sensitive!

<br/>

```{r, echo = TRUE}
Nome = "Margherita"

nome = "margherita"

Nome
nome

Nome == nome
```

### Dove vengono salvati gli oggetti?

Di default gli oggetti sono creati nel **global environment** accessibile con `ls()` o visibile in R Studio con anche alcune informazioni aggiuntive:

![](img/envi.png){fig-align="center" width="300"}

###

Possiamo eliminare un oggetto presente nel nostro enviroment attraverso il comando **`rm("nomeoggetto")`**.

E' possibile anche pulire completamente/svuotare il nostro enrivoment attraverso il comando **`rm(list = ls())`**.


## Funzioni

Tutto quello che facciamo in R è chiamare **funzioni** su oggetti.

Le funzioni ci permettono di **creare** e **modificare** oggetti.

```{r, echo = TRUE}
vettore
mean(x = vettore)
```


### Funzioni matematiche di base

Possiamo pensare alle funzioni in R in modo analogo alle classiche funzioni matematiche. Dati dei valori in **input**, le funzioni eseguono dei specifici calcoli e restituiscono in **output** il risultato ottenuto.

![](img/fun1.png){fig-align="center"}

### Argomenti

Gli argomenti delle funzioni sono quelli che da *utenti* dobbiamo conoscere ed impostare nel modo corretto per fare in modo che la funzioni faccia quello per cui è stata pensata. Nell'esempio precedente l'unico argomento era x. Vediamo invece l'`help` della funzione `mean()`.

###

Per impostare questi argomenti ci sono 2 regole:

-   l'ordine non conta SE DEFINISCO NOME DELL'ARGOMENTO con `x = vettore`, `na.rm = TRUE`, etc.
-   l'ordine conta SE NON DEFINISCO IL NOME DELL'ARGOMENTO. Posso quindi omettere `argomento = valore` ma devo rispettare l'ordine con cui è stata scritta la funzione.

###

In questo caso proviamo ad usare la funzione `mean()`:

```{r, error = TRUE, echo=TRUE}
myvec = rnorm(n = 1000, mean = 1, sd = 1)
# x definito,trim e na.rm non definito, quindi uguali a?
mean(x = myvec) 
?mean
```

::: fragment
```{r, echo = TRUE, warning=TRUE, error=TRUE}
mean(x = myvec, na.rm = TRUE) # x definito, na.rm definito

mean(myvec, TRUE) # cosa succede?
```
:::

### Packages

In R è possibile installare e caricare pacchetti aggiuntivi che non fanno altro che rendere disponibili librerie di funzioni create da altri utenti. Per utilizzare un pacchetto:

-   Installare il pacchetto con **`install.packages("nomepacchetto")`**

-   Caricare il pacchetto con **`library(nomepacchetto)`**

-   Accedere ad una funzione senza caricare il pachetto **`nomepacchetto::nomefunzione()`**. Utile se serve solo una funzione o ci sono conflitti)

### Packages

![](img/pkg.png){fig-align="center" width="300"}

## Operatori 

### Operatori Matematici

| Funzione | Cosa fa?        | Esempio     | Risultato |
|----------|-----------------|-------------|-----------|
| `+`      | addizione       | `5.4 + 6.1` | `11.5`    |
| `-`      | sottrazione     | `9 - 4.3`   | `4.7`     |
| `*`      | moltiplicazione | `7 * 1.4`   | `9.8`     |
| `/`      | divisione       | `9/3`       | `3`       |
| `%%`     | resto           | `9%%2`      | `1`       |
| `^`      | potenza         | `15 ^ 2`    | `225`     |


###

| Funzione | Cosa fa?               | Esempio           | Risultato |
|----------|------------------------|-------------------|-----------|
| `abs`    | valore assoluto        | `abs(-8)`         | `8`       |
| `sqrt`   | radice quadrata        | `sqrt(225)`       | `15`      |
| `exp`    | funzione esponenziale  | `exp(0)`          | `1`       |
| `log`    | logaritmo naturale     | `log(1)`          | `0`       |
| `round`  | arrotondamento, intero | `round(1.738)`    | `2`       |
| `round`  | arrotondamento         | `round(1.738, 2)` | `1.74`    |

### Operazioni Matematiche

L'ordine delle operazioni in R segue le regole della matematica.

**Esempi**

```{r, echo = TRUE}
# Senza parentesi
1 + 2 * 3

# Con le parentesi
(1 + 2) * 3
```

###  Operatori Relazionali

In R è possibile valutare se una data relazione è vera o falsa. R valuterà le proposizioni e ci restituirà il valore **`TRUE`** se la proposizione è vera oppure **`FALSE`** se la proposizione è falsa.


+---------------+-------------------+-------------------+---------------+
| Funzione      | Nome              | Esempio           | Risulato      |
+===============+===================+===================+===============+
| `==`          | uguale            | `30 == 30`        | `TRUE`        |
+---------------+-------------------+-------------------+---------------+
| `!=`          | diverso           | `30 != 30`        | `FALSE`       |
+---------------+-------------------+-------------------+---------------+
| `>`/`>=`      | maggiore/o uguale | `30 > 10`         | `TRUE`        |
|               |                   |                   |               |
|               |                   | `30 >= 10`        | `TRUE`        |
+---------------+-------------------+-------------------+---------------+
| `<`/`<=`      | minore/o uguale   | `30 < 10`         | `FALSE`       |
|               |                   |                   |               |
|               |                   | `10 <= 10`        | `TRUE`        |
+---------------+-------------------+-------------------+---------------+
| `%in%`        | inclusione        | `10%in%c(1,2,10)` | `TRUE`        |
+---------------+-------------------+-------------------+---------------+


###

Non vale solo per i numeri!

<br/>

```{r, echo = TRUE}
Nome = "Margherita"

nome = "margherita"

Nome == nome
```

<br/> PS. Ricordatevi che **`=`** è diverso da **`==`**

###  Operatori Logici

In R è possibile congiungere più relazioni per valutare una desiderata proposizione.

```{r,echo = TRUE}
x = 30 #Assegnamo a x il valore 30.
```

| Funzione | Nome                   | Esempio       | Risulato |
|----------|------------------------|---------------|----------|
| `&`      | Congiunzione           | `x>25 & x<60` | `TRUE`   |
| `|`      | Disgiunzione Inclusiva | `x>25 | x>60` | `TRUE`   |
| `!`      | Negazione              | `!(x<18)`     | `TRUE`   |

###

```{r,echo = TRUE}
x = 30 #Assegnamo a x il valore 30.
x
```

::: fragment
```{r, echo=TRUE, eval=FALSE}
x>25 & x>60
```
:::

::: fragment
```{r, echo=FALSE, eval=TRUE}
x>25 & x>60
```
:::

::: fragment
```{r, echo=TRUE, eval=FALSE}
x>25 | x>60
```
:::

::: fragment
```{r, echo=FALSE, eval=TRUE}
x>25 | x>60
```
:::

::: fragment
```{r, echo=TRUE, eval=FALSE}
!(x>18)
```
:::

::: fragment
```{r, echo=FALSE, eval=TRUE}
!(x>18)
```
:::


## R ed errori

In R gli errori sono:

-   inevitabili
-   parte del codice stesso
-   educativi

###

Ci sono diversi livelli di **allerta** quando scriviamo codice:

-   **`messaggi`**: la funzione ci restituisce qualcosa che è utile sapere, ma tutto liscio

-   **`warnings`**: la funzione ci informa di qualcosa di *potenzialmente* problematico, ma (circa) tutto liscio

-   **`error`**: la funzione non solo ci informa di un **errore** ma le operazioni richieste non sono state eseguite

###

Come risolvere?

-   Capire il messaggio
-   Leggere la documentazione della funzione
-   Cercare il messaggio su internet
-   Chiedere aiuto nei forum dedicati

###

-   Ogni funzione ha una pagina di documentazione accessibile con `?nomefunzione`, `??nomefunzione` oppure `help(nomefunzione)`

-   Possiamo cercare anche la documentazione del pacchetto

-   Possiamo cercare su internet il nome della funzione o l'eventuale messaggio che riceviamo

###

Facciamo un po' di pratica! {style="text-align: center;"}

<br/> Aprite e tenete aperto questo link: <https://etherpad.wikimedia.org/p/test-organizzazioni>

![](img/pad_condiviso.png){fig-align="center" width="400"}


